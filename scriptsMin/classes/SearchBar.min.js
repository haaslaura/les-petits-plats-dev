import{displayErrorMessage}from"../utils/displayErrorMessage.min.js";import{displayRecipesNumber}from"../utils/displayRecipesNumber.min.js";import{filterRecipes}from"../utils/filterRecipes.min.js";import{TagManager}from"./TagManager.min.js";export class SearchBar{constructor(e,r){this.recipes=e,this.filterOptions=r,this.searchBarTag=new TagManager(document.querySelector(".display-tag"),"search",this.filterOptions,e),this.searchForm=document.querySelector(".searchform"),this.searchBar=document.getElementById("searchbar"),this.searchButton=document.querySelector(".loop-icon"),this.errorMessage=null,this.initialize()}initialize(){this.initializeEventListeners()}checkInputValueValidity(e){e.preventDefault(),this.errorMessage=document.querySelector(".error-message"),this.errorMessage&&this.errorMessage.remove();document.querySelectorAll(".tag").forEach((e=>{e.querySelector("p").textContent===this.filterOptions.searchbarText&&this.searchBarTag.removeTag(e)})),!this.searchBar.checkValidity()||this.searchBar.value.length>0&&this.searchBar.value.length<3?(this.filterOptions.searchbarText="",filterRecipes(this.recipes,this.filterOptions),displayErrorMessage(this.searchBar.value),displayRecipesNumber([])):(this.filterOptions.searchbarText=this.searchBar.value,0!==this.searchBar.value.length&&this.searchBarTag.createTag(this.filterOptions.searchbarText,null,"search"),filterRecipes(this.recipes,this.filterOptions))}initializeEventListeners(){this.searchBar.addEventListener("focus",(function(){document.querySelector(".input-group").style.outline="3px solid rgb(255, 209, 91)",document.querySelector(".input-group").style.borderRadius="14px"})),this.searchBar.addEventListener("blur",(function(){document.querySelector(".input-group").style.outline="",document.querySelector(".input-group").style.borderRadius=""})),this.searchButton.addEventListener("click",(e=>{this.checkInputValueValidity(e)})),this.searchBar.addEventListener("keydown",(e=>{"Enter"===e.key&&this.checkInputValueValidity(e)})),this.searchBar.addEventListener("input",(()=>{if(""===this.searchBar.value.trim()){this.errorMessage=document.querySelector(".error-message"),this.errorMessage&&this.errorMessage.remove();document.querySelectorAll(".tag").forEach((e=>{e.querySelector("p").textContent===this.filterOptions.searchbarText&&this.searchBarTag.removeTag(e)})),this.filterOptions.searchbarText="",filterRecipes(this.recipes,this.filterOptions)}}))}}