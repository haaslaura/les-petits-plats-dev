import{displayErrorMessage}from"./displayErrorMessage.min.js";import{displayRecipes}from"./displayRecipes.min.js";import{displayRecipesNumber}from"./displayRecipesNumber.min.js";export function filterRecipes(e,t){const{searchbarText:s,filters:n}=t,{selectedIngredients:i,selectedAppliances:r,selectedUstensils:l}=n,o=new RegExp(s,"gi"),d=[],p=document.querySelector(".error-message");if(p&&p.remove(),""===s&&0===i.length&&0===r.length&&0===l.length){const t=new CustomEvent("new-filter",{detail:e}),s=document.getElementById("dropdown-ingredients"),n=document.getElementById("dropdown-appliances"),i=document.getElementById("dropdown-utils");return s.dispatchEvent(t),n.dispatchEvent(t),i.dispatchEvent(t),displayRecipes(e),void displayRecipesNumber(e)}for(let t=0;t<e.length;t++){const n=e[t];let p=!0,a=!0,c=!0,g=!0;if(""!==s)if(p=!1,o.test(n.name)||o.test(n.description))p=!0;else for(let e=0;e<n.ingredients.length;e++)if(o.test(n.ingredients[e].ingredient)){p=!0;break}if(r.length>0&&(c=!1,n.appliance.toLowerCase().includes(r[0].toLowerCase())&&(c=!0)),i.length>0){a=!0;for(let e=0;e<i.length;e++){let t=!1;for(let s=0;s<n.ingredients.length;s++)if(n.ingredients[s].ingredient.toLowerCase().includes(i[e].toLowerCase())){t=!0;break}if(!t){a=!1;break}}}if(l.length>0)if(g=!1,l.length>n.ustensils.length)g=!1;else{const e=[];for(let t=0;t<n.ustensils.length;t++)e.push(n.ustensils[t].toLowerCase());g=!0;for(let t=0;t<l.length;t++)if(!e.includes(l[t].toLowerCase())){g=!1;break}}p&&a&&c&&g&&d.push(n)}if(d.length>0){const e=new CustomEvent("new-filter",{detail:d}),t=document.getElementById("dropdown-ingredients"),s=document.getElementById("dropdown-appliances"),n=document.getElementById("dropdown-utils");t.dispatchEvent(e),s.dispatchEvent(e),n.dispatchEvent(e),displayRecipes(d),displayRecipesNumber(d)}else{const e=document.querySelector(".error-message");e&&e.remove(),displayErrorMessage(s),displayRecipesNumber([])}}